local karazhan = {}
table.insert(karazhan, { encounterName = "Attumen the Huntsman", id = 652, targets = { "Attumen the Huntsman" } })
table.insert(karazhan, { encounterName = "Moroes", id = 653, targets = { "Moroes" } })
table.insert(karazhan, { encounterName = "Maiden of Virtue", id = 654, targets = { "Maiden of Virtue" } })
table.insert(karazhan, { encounterName = "Opera Hall", id = 655, targets = { "Opera Hall" } })
table.insert(karazhan, { encounterName = "Nightbane", id = 662, targets = { "Nightbane" } })
table.insert(karazhan, { encounterName = "The Curator", id = 656, targets = { "The Curator" } })
table.insert(karazhan, { encounterName = "Terestian Illhoof", id = 657, targets = { "Terestian Illhoof" } })
table.insert(karazhan, { encounterName = "Shade of Aran", id = 658, targets = { "Shade of Aran" } })
table.insert(karazhan, { encounterName = "Netherspite", id = 659, targets = { "Netherspite" } })
table.insert(karazhan, { encounterName = "Prince Malchezaar", id = 661, targets = { "Prince Malchezaar" } })

local gruulsLair = {}
table.insert(gruulsLair, { encounterName = "High King Maulgar", id = 649, targets = { "High King Maulgar" } })
table.insert(gruulsLair, { encounterName = "Gruul the Dragonkiller", id = 650, targets = { "Gruul the Dragonkiller" } })

local magtheridonsLair = {}
table.insert(magtheridonsLair, { encounterName = "Magtheridon", id = 651, targets = { "Magtheridon" } })

local ssc = {}
table.insert(ssc, { encounterName = "The Lurker Below", id = 624, targets = { "The Lurker Below" } })
table.insert(ssc, { encounterName = "Hydross the Unstable", id = 623, targets = { "Hydross the Unstable" } })
table.insert(ssc, { encounterName = "Leotheras the Blind", id = 625, targets = { "Leotheras the Blind" } })
table.insert(ssc, { encounterName = "Fathom-Lord Karathress", id = 626, targets = { "Fathom-Lord Karathress" } })
table.insert(ssc, { encounterName = "Morogrim Tidewalker", id = 627, targets = { "Morogrim Tidewalker" } })
table.insert(ssc, { encounterName = "Lady Vashj", id = 628, targets = { "Lady Vashj" } })

local tk = {}
table.insert(tk, { encounterName = "High Astromancer Solarian", id = 732, targets = { "High Astromancer Solarian" } })
table.insert(tk, { encounterName = "A'lar", id = 730, targets = { "A'lar" } })
table.insert(tk, { encounterName = "Void Reaver", id = 731, targets = { "Void Reaver" } })
table.insert(tk, { encounterName = "Kael'thas Sunstrider", id = 733, targets = { "Kael'thas Sunstrider" } })

local hyjal = {}
table.insert(hyjal, { encounterName = "Rage Winterchill", id = 618, targets = { "Rage Winterchill" } })
table.insert(hyjal, { encounterName = "Anetheron", id = 619, targets = { "Anetheron" } })
table.insert(hyjal, { encounterName = "Kaz'rogal", id = 620, targets = { "Kaz'rogal" } })
table.insert(hyjal, { encounterName = "Azgalor", id = 621, targets = { "Azgalor" } })
table.insert(hyjal, { encounterName = "Archimonde", id = 622, targets = { "Archimonde" } })

local bt = {}
table.insert(bt, { encounterName = "High Warlord Naj'entus", id = 601, targets = { "High Warlord Naj'entus" } })
table.insert(bt, { encounterName = "Supremus", id = 602, targets = { "Supremus" } })
table.insert(bt, { encounterName = "Shade of Akama", id = 603, targets = { "Shade of Akama" } })
table.insert(bt, { encounterName = "Teron Gorefiend", id = 604, targets = { "Teron Gorefiend" } })
table.insert(bt, { encounterName = "Reliquary of Souls", id = 605, targets = { "Essence of Suffering" } })
table.insert(bt, { encounterName = "Gurtogg Bloodboil", id = 606, targets = { "Gurtogg Bloodboil" } })
table.insert(bt, { encounterName = "Mother Shahraz", id = 607, targets = { "Mother Shahraz" } })
table.insert(bt, { encounterName = "The Illidari Council", id = 608, targets = { "Lady Malande", "Gathios the Shatterer", "Veras Darkshadow", "High Nethermancer Zerevor" } })
table.insert(bt, { encounterName = "Illidan Stormrage", id = 609, targets = { "Illidan Stormrage" } })

local za = {}
table.insert(za, { encounterName = "Akil'zon", id = 1189, targets = { "Akil'zon" } })
table.insert(za, { encounterName = "Nalorakk", id = 1190, targets = { "Nalorakk" } })
table.insert(za, { encounterName = "Jan'alai", id = 1191, targets = { "Jan'alai" } })
table.insert(za, { encounterName = "Halazzi", id = 1192, targets = { "Halazzi" } })
table.insert(za, { encounterName = "Hex Lord Malacrass", id = 1193, targets = { "Hex Lord Malacrass" } })
table.insert(za, { encounterName = "Zul'jin", id = 1194, targets = { "Zul'jin" } })

local sunwell = {}
table.insert(sunwell, { encounterName = "Kalecgos", id = 724, targets = { "Kalecgos" } })
table.insert(sunwell, { encounterName = "Brutallus", id = 725, targets = { "Brutallus" } })
table.insert(sunwell, { encounterName = "Felmyst", id = 726, targets = { "Felmyst" } })
table.insert(sunwell, { encounterName = "Eredar Twins", id = 727, targets = { "Lady Sacrolash", "Grand Warlock Alythess" } })
table.insert(sunwell, { encounterName = "M'uru", id = 728, targets = { "M'uru" } })
table.insert(sunwell, { encounterName = "Kil'jaeden", id = 729, targets = { "Kil'jaeden", "Hand of the Deceiver" } })

local test = {}
table.insert(test, { encounterName = "High Overlord Saurfang", id = 1, targets = { "High Overlord Saurfang" } })
table.insert(test, { encounterName = "Overlord Runthak", id = 2, targets = { "Overlord Runthak" } })

raids = {}
raids["Karazhan"]             = { encounters = karazhan, currentEncounter = 1 }
raids["Gruul's Lair"]         = { encounters = gruulsLair, currentEncounter = 1 }
raids["Magtheridon's Lair"]   = { encounters = magtheridonsLair, currentEncounter = 1 }
raids["Serpentshrine Cavern"] = { encounters = ssc, currentEncounter = 1 }
raids["Tempest Keep"]         = { encounters = tk, currentEncounter = 1 }
raids["Hyjal Summit"]         = { encounters = hyjal, currentEncounter = 1 }
raids["Black Temple"]         = { encounters = bt, currentEncounter = 1 }
raids["Zul'Aman"]             = { encounters = za, currentEncounter = 1 }
raids["The Sunwell"]          = { encounters = sunwell, currentEncounter = 1 }

raidAliases = {}
raidAliases["The Eye"]                    = "Tempest Keep"
-- raidAliases["Sunwell Plateau"]            = "The Sunwell" -- maybe unnecessary?
raidAliases["The Battle for Mount Hyjal"] = "Hyjal Summit"

currentEncounters = {}
for k,_ in pairs(raids) do
	currentEncounters[k] = 1
end

function BossExistsInRaid(zone, boss)
	if not raids[zone] then return end

	for _,v in ipairs(raids[zone]) do
		if v == boss then return true end
	end

	return false
end

function SetCurrentEncounter(zone, boss)
	if not raids[zone] then return end

	for i,v in pairs(raids[zone]) do
		if v == boss then currentEncounters[zone] = i end
	end
end

function UpdateCurrentEncounters(zone)
	local function MapEncounterToZone(encounterName)
		return raidAliases[encounterName] or encounterName
	end

	for i = 1, GetNumSavedInstances() do
		local name,_,_,_,_,_,_,_,_,_,_,encounterProgress = GetSavedInstanceInfo(i)
		local zone = MapEncounterToZone(name)

		for k,_ in pairs(currentEncounters) do
			if k == zone then
				currentEncounters[k] = encounterProgress + 1
			end
		end
	end
end